<div class="container">
    <div class="qr-category__container">
        <div ng-repeat="category in ctrl.categories">
            <button class="qr-category__link btn" ng-click="ctrl.selectCategory(category.id)">{{category.shortCode}}</button>
        </div>
    </div>
</div>

<div class="container-fluid text-center" ng-if="ctrl.qrs">

    <svg class="bigqrcode">
        <style type="text/css" >
            path.production:hover {
                stroke : {{ctrl.parameterMap.qrcode_colour_hover}};
            }
            text{
                fill: {{ctrl.parameterMap.qrcode_colour_text}};
                font-size: {{ctrl.text.size}};
            }
        </style>

        <g>

            <svg ng-repeat="qr in ctrl.qrs"
                 ng-attr-width="{{qr.background.dimensionScaled}}"
                 ng-attr-height="{{qr.background.dimensionScaled}}"
                 ng-attr-x="{{qr.background.x}}"
                 ng-attr-y="{{qr.background.y}}">

                <rect fill="{{ctrl.parameterMap.qrcode_background}}" stroke="{{ctrl.parameterMap.qrcode_background}}"
                      ng-attr-width="{{qr.background.dimensionScaled}}"
                      ng-attr-height="{{qr.background.dimensionScaled}}">
                </rect>

            </svg>

            <text  fill-opacity="1" ng-attr-x="{{ctrl.text.x}}" ng-attr-y="{{ctrl.text.y}}" font-family="Bad Script" >{{ctrl.text.content}}</text>

            <svg ng-repeat="qr in ctrl.qrs"
                 ng-attr-width="{{qr.foreground.dimensionScaled}}"
                 ng-attr-height="{{qr.foreground.dimensionScaled}}"
                 ng-attr-x="{{qr.foreground.x}}"
                 ng-attr-y="{{qr.foreground.y}}">

                <path class="{{!!qr.production ? 'production' : 'naproduction'}}" ng-attr-stroke="{{!!qr.production ? ctrl.parameterMap.qrcode_foreground : ctrl.parameterMap.qrcode_foreground_na }}"
                      ng-attr-transform="scale({{qr.scaleRatio}})"
                      ng-attr-width="{{qr.foreground.dimensionScaled}}"
                      ng-attr-height="{{qr.foreground.dimensionScaled}}"
                      ng-attr-d="{{qr.svgPath}}"
                      ng-click="ctrl.seeProduction(qr)">
                </path>
            </svg>

        </g>
    </svg>
</div>

<script type="text/ng-template" id="seeProduction.html">
    <div class="modal-body">
        <p> Créé le <b>{{ selected.createdAt | ewDate}}</b> par <b>{{ selected.user.esmeid}}</b></p>

        <p>{{ selected.content }}</p>
    </div>
</script>